{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/PierreKevinAngelo/Web-Vapers/blob/main/Klasifikasi%20Teks%20menggunakan%20LSTM\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from google.colab import drive\n",
        "drive.mount('/content/drive')"
      ],
      "metadata": {
        "id": "rCPWcu2W_R7V",
        "outputId": "a74b996a-512b-4a2d-fa00-8a268adc1986",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 1,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Mounted at /content/drive\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "import re\n",
        "import string\n",
        "import nltk\n",
        "nltk.download('punkt')"
      ],
      "metadata": {
        "id": "wQwFn4D9ZpK9",
        "outputId": "1a36a6a3-0c4f-41cb-b318-5b81ecde184e",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "[nltk_data] Downloading package punkt to /root/nltk_data...\n",
            "[nltk_data]   Unzipping tokenizers/punkt.zip.\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "True"
            ]
          },
          "metadata": {},
          "execution_count": 2
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df=pd.read_csv('/content/drive/MyDrive/Twitter_Emotion_Dataset.csv')\n",
        "df['label'].value_counts()"
      ],
      "metadata": {
        "id": "FqKdEoolZpZf",
        "outputId": "d8a44f82-d9c1-4f95-eaec-03c8fbd99d91",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 3,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "anger      1101\n",
              "happy      1017\n",
              "sadness     997\n",
              "fear        649\n",
              "love        637\n",
              "Name: label, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 3
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df['word_length'] = df['tweet'].str.split()\n",
        "df['word_length'] = df['word_length'].str.len()\n",
        "df.dropna(inplace=True)"
      ],
      "metadata": {
        "id": "TKoHcx5xZpcd"
      },
      "execution_count": 4,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "df['word_length'].sort_values(ascending=False)"
      ],
      "metadata": {
        "id": "xKk4r6A4Zpm4",
        "outputId": "35f62487-f5d9-454b-c445-798ea7189633",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 5,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "1949    80\n",
              "680     58\n",
              "477     57\n",
              "3372    54\n",
              "3101    53\n",
              "        ..\n",
              "4329     3\n",
              "2738     3\n",
              "1243     3\n",
              "3447     3\n",
              "1222     2\n",
              "Name: word_length, Length: 4401, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 5
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from keras.preprocessing.text import Tokenizer\n",
        "from sklearn.model_selection import train_test_split\n",
        "from keras.preprocessing.text import Tokenizer\n",
        "from keras.preprocessing.sequence import pad_sequences\n",
        "from keras.models import Sequential\n",
        "from keras.layers import Dense\n",
        "from keras.layers import Flatten\n",
        "from keras.layers import LSTM\n",
        "from keras.layers import Embedding\n",
        "from keras.layers import SpatialDropout1D\n",
        "\n",
        "MAX_WORDS = 2500\n",
        "MAX_SEQUENCE_LENGTH = 355\n",
        "EMBEDDING_DIM = 100\n",
        "\n",
        "tokenizer = Tokenizer(num_words=MAX_WORDS, filters='!\"#$%&()*+,-./:;<=>?@[\\]^_`{|}~')\n",
        "tokenizer.fit_on_texts(df.tweet.values)\n",
        "word_index = tokenizer.word_index\n",
        "X = tokenizer.texts_to_sequences(df.tweet.values)"
      ],
      "metadata": {
        "id": "dp4Np_ihZppz"
      },
      "execution_count": 6,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "df.tweet.values[0]"
      ],
      "metadata": {
        "id": "xDV6xrt6aEcp",
        "outputId": "023bf78f-8199-48ef-8b02-100a073a0d52",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 52
        }
      },
      "execution_count": 7,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "'Soal jln Jatibaru,polisi tdk bs GERTAK gubernur .Emangny polisi tdk ikut pmbhasan? Jgn berpolitik. Pengaturan wilayah,hak gubernur. Persoalan Tn Abang soal turun temurun.Pelik.Perlu kesabaran. [USERNAME] [USERNAME] [URL]'"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "string"
            }
          },
          "metadata": {},
          "execution_count": 7
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "X[0]"
      ],
      "metadata": {
        "id": "o2DAzXCnaEe8",
        "outputId": "58200b7f-3e27-4a9f-d59b-4094250ea981",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 10,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "[328,\n",
              " 2050,\n",
              " 814,\n",
              " 174,\n",
              " 453,\n",
              " 744,\n",
              " 814,\n",
              " 174,\n",
              " 268,\n",
              " 350,\n",
              " 2342,\n",
              " 878,\n",
              " 744,\n",
              " 1834,\n",
              " 745,\n",
              " 328,\n",
              " 746,\n",
              " 291,\n",
              " 1307,\n",
              " 1,\n",
              " 1,\n",
              " 19]"
            ]
          },
          "metadata": {},
          "execution_count": 10
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "tokenizer.word_index"
      ],
      "metadata": {
        "id": "G_tzblTdaEii",
        "outputId": "d6b4ec39-ac8a-4bda-fce3-ff0dac06bfbc",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 9,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "{'username': 1,\n",
              " 'dan': 2,\n",
              " 'yg': 3,\n",
              " 'yang': 4,\n",
              " 'di': 5,\n",
              " 'aku': 6,\n",
              " 'ini': 7,\n",
              " 'itu': 8,\n",
              " 'ada': 9,\n",
              " 'ya': 10,\n",
              " 'sama': 11,\n",
              " 'ga': 12,\n",
              " 'tapi': 13,\n",
              " 'bisa': 14,\n",
              " 'saya': 15,\n",
              " 'dia': 16,\n",
              " 'aja': 17,\n",
              " 'kita': 18,\n",
              " 'url': 19,\n",
              " 'mau': 20,\n",
              " 'ke': 21,\n",
              " 'orang': 22,\n",
              " 'kalo': 23,\n",
              " 'gue': 24,\n",
              " 'lagi': 25,\n",
              " 'kamu': 26,\n",
              " 'jadi': 27,\n",
              " 'dari': 28,\n",
              " 'udah': 29,\n",
              " 'juga': 30,\n",
              " 'gak': 31,\n",
              " 'apa': 32,\n",
              " 'sayang': 33,\n",
              " 'dengan': 34,\n",
              " 'tidak': 35,\n",
              " 'cinta': 36,\n",
              " 'untuk': 37,\n",
              " 'takut': 38,\n",
              " 'buat': 39,\n",
              " 'banget': 40,\n",
              " 'nya': 41,\n",
              " 'sih': 42,\n",
              " 'karena': 43,\n",
              " 'sudah': 44,\n",
              " 'masih': 45,\n",
              " 'selalu': 46,\n",
              " 'banyak': 47,\n",
              " 'lebih': 48,\n",
              " 'akan': 49,\n",
              " 'mereka': 50,\n",
              " 'gitu': 51,\n",
              " 'tak': 52,\n",
              " 'kalau': 53,\n",
              " 'tau': 54,\n",
              " 'gw': 55,\n",
              " 'semua': 56,\n",
              " 'tp': 57,\n",
              " 'ku': 58,\n",
              " 'pas': 59,\n",
              " 'terus': 60,\n",
              " 'atau': 61,\n",
              " 'hari': 62,\n",
              " 'suka': 63,\n",
              " 'kan': 64,\n",
              " 'pernah': 65,\n",
              " 'harus': 66,\n",
              " 'baru': 67,\n",
              " 'bukan': 68,\n",
              " 'bikin': 69,\n",
              " 'cuma': 70,\n",
              " 'dulu': 71,\n",
              " 'sendiri': 72,\n",
              " 'jangan': 73,\n",
              " 'lain': 74,\n",
              " 'punya': 75,\n",
              " 'anak': 76,\n",
              " 'pada': 77,\n",
              " 'baik': 78,\n",
              " 'adalah': 79,\n",
              " 'gua': 80,\n",
              " 'hati': 81,\n",
              " 'hanya': 82,\n",
              " 'salah': 83,\n",
              " 'saat': 84,\n",
              " 'dalam': 85,\n",
              " 'malah': 86,\n",
              " 'bgt': 87,\n",
              " 'si': 88,\n",
              " 'sampe': 89,\n",
              " 'lah': 90,\n",
              " 'saja': 91,\n",
              " 'satu': 92,\n",
              " 'semoga': 93,\n",
              " 'kok': 94,\n",
              " 'allah': 95,\n",
              " 'sekarang': 96,\n",
              " 'kasih': 97,\n",
              " 'kau': 98,\n",
              " 'hal': 99,\n",
              " 'pake': 100,\n",
              " 'waktu': 101,\n",
              " 'mungkin': 102,\n",
              " 'tuh': 103,\n",
              " 'kami': 104,\n",
              " 'jd': 105,\n",
              " 'emang': 106,\n",
              " 'biar': 107,\n",
              " 'paling': 108,\n",
              " 'bilang': 109,\n",
              " 'kali': 110,\n",
              " 'pasti': 111,\n",
              " 'makan': 112,\n",
              " 'sampai': 113,\n",
              " 'kalian': 114,\n",
              " 'kenapa': 115,\n",
              " 'hidup': 116,\n",
              " 'menjadi': 117,\n",
              " 'padahal': 118,\n",
              " 'seperti': 119,\n",
              " 'jam': 120,\n",
              " 'temen': 121,\n",
              " 'gimana': 122,\n",
              " 'jg': 123,\n",
              " 'udh': 124,\n",
              " 'pak': 125,\n",
              " 'diri': 126,\n",
              " 'org': 127,\n",
              " 'karna': 128,\n",
              " 'deh': 129,\n",
              " 'ketika': 130,\n",
              " 'jalan': 131,\n",
              " 'rumah': 132,\n",
              " 'lu': 133,\n",
              " 'ternyata': 134,\n",
              " 'krn': 135,\n",
              " 'sakit': 136,\n",
              " 'gini': 137,\n",
              " 'liat': 138,\n",
              " 'belum': 139,\n",
              " 'lalu': 140,\n",
              " 'sekali': 141,\n",
              " 'rasa': 142,\n",
              " 'mana': 143,\n",
              " 'makin': 144,\n",
              " 'klo': 145,\n",
              " 'anda': 146,\n",
              " 'sm': 147,\n",
              " 'pengen': 148,\n",
              " 'tempat': 149,\n",
              " 'w': 150,\n",
              " 'tahun': 151,\n",
              " 'nih': 152,\n",
              " 'langsung': 153,\n",
              " 'kayak': 154,\n",
              " 'indonesia': 155,\n",
              " '2': 156,\n",
              " 'lg': 157,\n",
              " 'pulang': 158,\n",
              " 'jika': 159,\n",
              " 'selamat': 160,\n",
              " 'sangat': 161,\n",
              " 'lama': 162,\n",
              " 'dgn': 163,\n",
              " 'memang': 164,\n",
              " 'pun': 165,\n",
              " 'iya': 166,\n",
              " 'nanti': 167,\n",
              " 'jatuh': 168,\n",
              " 'masa': 169,\n",
              " 'dr': 170,\n",
              " 'tanpa': 171,\n",
              " 'kaya': 172,\n",
              " 'bener': 173,\n",
              " 'tdk': 174,\n",
              " 'siapa': 175,\n",
              " 'akhirnya': 176,\n",
              " 'setelah': 177,\n",
              " 'lo': 178,\n",
              " 'masuk': 179,\n",
              " 'eh': 180,\n",
              " 'trus': 181,\n",
              " 'tidur': 182,\n",
              " 'dong': 183,\n",
              " 'apalagi': 184,\n",
              " 'kerja': 185,\n",
              " 'nggak': 186,\n",
              " 'sering': 187,\n",
              " 'bulan': 188,\n",
              " 'begitu': 189,\n",
              " 'bahwa': 190,\n",
              " '1': 191,\n",
              " 'minta': 192,\n",
              " 'tuhan': 193,\n",
              " 'kata': 194,\n",
              " 'i': 195,\n",
              " 'mas': 196,\n",
              " 'ingin': 197,\n",
              " 'malam': 198,\n",
              " 'ngga': 199,\n",
              " '3': 200,\n",
              " 'merasa': 201,\n",
              " 'tiap': 202,\n",
              " 'baca': 203,\n",
              " 'oleh': 204,\n",
              " 'terima': 205,\n",
              " 'beli': 206,\n",
              " 'tadi': 207,\n",
              " 'utk': 208,\n",
              " 'sy': 209,\n",
              " 'mah': 210,\n",
              " 'kepada': 211,\n",
              " 'bahagia': 212,\n",
              " 'ibu': 213,\n",
              " 'bapak': 214,\n",
              " 'abis': 215,\n",
              " 'bakal': 216,\n",
              " 'coba': 217,\n",
              " 'teman': 218,\n",
              " 'rasanya': 219,\n",
              " 'd': 220,\n",
              " 'setiap': 221,\n",
              " 'happy': 222,\n",
              " 'depan': 223,\n",
              " 'tahu': 224,\n",
              " 'trs': 225,\n",
              " 'dunia': 226,\n",
              " 'mulai': 227,\n",
              " 'benar': 228,\n",
              " 'alhamdulillah': 229,\n",
              " 'biasa': 230,\n",
              " 'main': 231,\n",
              " 'you': 232,\n",
              " 'kembali': 233,\n",
              " 'nonton': 234,\n",
              " 'mu': 235,\n",
              " 'kadang': 236,\n",
              " 'bersama': 237,\n",
              " 'besar': 238,\n",
              " 'sambil': 239,\n",
              " 'membuat': 240,\n",
              " 'jauh': 241,\n",
              " 'saling': 242,\n",
              " 'bagi': 243,\n",
              " 'pagi': 244,\n",
              " 'buka': 245,\n",
              " 'katanya': 246,\n",
              " 'negara': 247,\n",
              " 'belajar': 248,\n",
              " 'lupa': 249,\n",
              " 'sebagai': 250,\n",
              " 'sekolah': 251,\n",
              " 'cerita': 252,\n",
              " 'pertama': 253,\n",
              " 'kek': 254,\n",
              " 'keluar': 255,\n",
              " 'dapat': 256,\n",
              " 'wkwk': 257,\n",
              " 'atas': 258,\n",
              " 'dah': 259,\n",
              " 'ketemu': 260,\n",
              " 'sdh': 261,\n",
              " 'ngomong': 262,\n",
              " 'papa': 263,\n",
              " \"'\": 264,\n",
              " 'enak': 265,\n",
              " 'kurang': 266,\n",
              " 'mata': 267,\n",
              " 'ikut': 268,\n",
              " 'n': 269,\n",
              " 'apapun': 270,\n",
              " 'tetap': 271,\n",
              " 'semakin': 272,\n",
              " 'terlalu': 273,\n",
              " 'balik': 274,\n",
              " 'manusia': 275,\n",
              " 'serem': 276,\n",
              " 'mati': 277,\n",
              " 'sehat': 278,\n",
              " 'cara': 279,\n",
              " 'bahkan': 280,\n",
              " 'masalah': 281,\n",
              " 'via': 282,\n",
              " 'yah': 283,\n",
              " 'gt': 284,\n",
              " 'foto': 285,\n",
              " 'jelas': 286,\n",
              " 'presiden': 287,\n",
              " 'dg': 288,\n",
              " 'doang': 289,\n",
              " 'lagu': 290,\n",
              " 'perlu': 291,\n",
              " 'pergi': 292,\n",
              " 'namun': 293,\n",
              " 'susah': 294,\n",
              " 'a': 295,\n",
              " 'bagus': 296,\n",
              " 'ngeri': 297,\n",
              " 'datang': 298,\n",
              " 'beliau': 299,\n",
              " 'seorang': 300,\n",
              " 'tentang': 301,\n",
              " 'cari': 302,\n",
              " 'gk': 303,\n",
              " 'kecil': 304,\n",
              " 'keluarga': 305,\n",
              " 'selama': 306,\n",
              " 'tetep': 307,\n",
              " 'dapet': 308,\n",
              " 'para': 309,\n",
              " 'semangat': 310,\n",
              " 'the': 311,\n",
              " 'skrg': 312,\n",
              " 'seseorang': 313,\n",
              " 'disini': 314,\n",
              " 'nangis': 315,\n",
              " 'rindu': 316,\n",
              " '5': 317,\n",
              " 'naik': 318,\n",
              " 'kangen': 319,\n",
              " 'nah': 320,\n",
              " 'telah': 321,\n",
              " 'sedih': 322,\n",
              " 'cewek': 323,\n",
              " 'lebaran': 324,\n",
              " 'puasa': 325,\n",
              " 'rakyat': 326,\n",
              " 'pakai': 327,\n",
              " 'soal': 328,\n",
              " 'sedang': 329,\n",
              " 'tolong': 330,\n",
              " 'boleh': 331,\n",
              " 'makanya': 332,\n",
              " 'mama': 333,\n",
              " 'haha': 334,\n",
              " 'sini': 335,\n",
              " 'air': 336,\n",
              " 'apakah': 337,\n",
              " 'habis': 338,\n",
              " 'to': 339,\n",
              " 'namanya': 340,\n",
              " 'love': 341,\n",
              " 'uang': 342,\n",
              " 'mikir': 343,\n",
              " 'tua': 344,\n",
              " 'cantik': 345,\n",
              " 'ia': 346,\n",
              " 'soalnya': 347,\n",
              " 'maka': 348,\n",
              " 'sebuah': 349,\n",
              " 'jgn': 350,\n",
              " 'kemarin': 351,\n",
              " '4': 352,\n",
              " 'yaa': 353,\n",
              " 'luar': 354,\n",
              " 'beda': 355,\n",
              " 'kl': 356,\n",
              " 'kapan': 357,\n",
              " 'tiba': 358,\n",
              " 'sebelum': 359,\n",
              " 'lihat': 360,\n",
              " 'melihat': 361,\n",
              " 'agar': 362,\n",
              " 'beberapa': 363,\n",
              " 'mbak': 364,\n",
              " 'siang': 365,\n",
              " 'kelas': 366,\n",
              " 'mampu': 367,\n",
              " 'ama': 368,\n",
              " 'sadar': 369,\n",
              " 'cukup': 370,\n",
              " 'demi': 371,\n",
              " 'lewat': 372,\n",
              " 'diam': 373,\n",
              " 'butuh': 374,\n",
              " 'pacar': 375,\n",
              " 'tu': 376,\n",
              " 'penting': 377,\n",
              " 'maaf': 378,\n",
              " 'mohon': 379,\n",
              " 'kantor': 380,\n",
              " 'ganti': 381,\n",
              " 'muka': 382,\n",
              " 'walaupun': 383,\n",
              " 'senyum': 384,\n",
              " 'terimakasih': 385,\n",
              " 'kuliah': 386,\n",
              " 'dimana': 387,\n",
              " 'perempuan': 388,\n",
              " 'gabisa': 389,\n",
              " 'sahabat': 390,\n",
              " 'my': 391,\n",
              " 'me': 392,\n",
              " 'ngerasa': 393,\n",
              " 'bareng': 394,\n",
              " 'cuman': 395,\n",
              " 'panjang': 396,\n",
              " 'nanya': 397,\n",
              " 'no': 398,\n",
              " 'wa': 399,\n",
              " 'terjadi': 400,\n",
              " 'blm': 401,\n",
              " 'twitter': 402,\n",
              " 'marah': 403,\n",
              " 'bawa': 404,\n",
              " 'ig': 405,\n",
              " 'u': 406,\n",
              " 'hahaha': 407,\n",
              " 'bila': 408,\n",
              " 'segala': 409,\n",
              " 'tinggal': 410,\n",
              " 'ngerti': 411,\n",
              " 'bangun': 412,\n",
              " 'percaya': 413,\n",
              " 'seneng': 414,\n",
              " 'sedikit': 415,\n",
              " 'berubah': 416,\n",
              " 'penuh': 417,\n",
              " 'yakin': 418,\n",
              " 'dua': 419,\n",
              " 'makasih': 420,\n",
              " 'emg': 421,\n",
              " '2018': 422,\n",
              " 'ah': 423,\n",
              " 'nikah': 424,\n",
              " 'berani': 425,\n",
              " 'film': 426,\n",
              " 'parah': 427,\n",
              " 'in': 428,\n",
              " 'otak': 429,\n",
              " 'awal': 430,\n",
              " 'jaman': 431,\n",
              " 'secara': 432,\n",
              " 'vallen': 433,\n",
              " 'biasanya': 434,\n",
              " 'bersyukur': 435,\n",
              " 'agama': 436,\n",
              " 'agak': 437,\n",
              " 'pokoknya': 438,\n",
              " 'kena': 439,\n",
              " 'dlm': 440,\n",
              " 'baju': 441,\n",
              " 'tanya': 442,\n",
              " 'sore': 443,\n",
              " 'akhir': 444,\n",
              " 'sana': 445,\n",
              " 'akun': 446,\n",
              " 'ngobrol': 447,\n",
              " 'mulu': 448,\n",
              " 'sma': 449,\n",
              " 'kuat': 450,\n",
              " 'jokowi': 451,\n",
              " 'mencintai': 452,\n",
              " 'bs': 453,\n",
              " 'jawab': 454,\n",
              " 'orang2': 455,\n",
              " 'niat': 456,\n",
              " 'islam': 457,\n",
              " 'and': 458,\n",
              " 'kak': 459,\n",
              " 'bagaimana': 460,\n",
              " 'doi': 461,\n",
              " 'berusaha': 462,\n",
              " 'so': 463,\n",
              " 'malem': 464,\n",
              " 'oh': 465,\n",
              " 'sabar': 466,\n",
              " 'terbaik': 467,\n",
              " 'hrs': 468,\n",
              " 'hp': 469,\n",
              " 'sesuatu': 470,\n",
              " 'deket': 471,\n",
              " 'malu': 472,\n",
              " 'jakarta': 473,\n",
              " 'jiwa': 474,\n",
              " 'pd': 475,\n",
              " 'setan': 476,\n",
              " 'politik': 477,\n",
              " 'wanita': 478,\n",
              " 'hehe': 479,\n",
              " 'dikit': 480,\n",
              " 'anaknya': 481,\n",
              " 'gatau': 482,\n",
              " 'perasaan': 483,\n",
              " 'cewe': 484,\n",
              " 'lucu': 485,\n",
              " 'sulit': 486,\n",
              " 'pelecehan': 487,\n",
              " 'bingung': 488,\n",
              " 'cowo': 489,\n",
              " 'begini': 490,\n",
              " 'chat': 491,\n",
              " 'umur': 492,\n",
              " 'bener2': 493,\n",
              " 'diem': 494,\n",
              " 'alasan': 495,\n",
              " 'usah': 496,\n",
              " 'muncul': 497,\n",
              " 'aneh': 498,\n",
              " 'nyaman': 499,\n",
              " 'kemudian': 500,\n",
              " 'tinggi': 501,\n",
              " 'sexual': 502,\n",
              " 'lbh': 503,\n",
              " 'duit': 504,\n",
              " 'semuanya': 505,\n",
              " 'sok': 506,\n",
              " 'kabar': 507,\n",
              " 'tengah': 508,\n",
              " 'hampir': 509,\n",
              " 'melakukan': 510,\n",
              " 'loh': 511,\n",
              " 'suatu': 512,\n",
              " 'sukses': 513,\n",
              " 'mobil': 514,\n",
              " 'menurut': 515,\n",
              " 'kalah': 516,\n",
              " 'g': 517,\n",
              " 'dikasih': 518,\n",
              " 'up': 519,\n",
              " 'gila': 520,\n",
              " '6': 521,\n",
              " 'serius': 522,\n",
              " 'indah': 523,\n",
              " 'gara2': 524,\n",
              " 'belom': 525,\n",
              " 'duduk': 526,\n",
              " 'entah': 527,\n",
              " 'doa': 528,\n",
              " 'keras': 529,\n",
              " 'pula': 530,\n",
              " 'swt': 531,\n",
              " 'sampah': 532,\n",
              " '10': 533,\n",
              " 'sebenarnya': 534,\n",
              " 'amat': 535,\n",
              " 'memberikan': 536,\n",
              " 'berarti': 537,\n",
              " 'orangnya': 538,\n",
              " 'mending': 539,\n",
              " 'btw': 540,\n",
              " 'paham': 541,\n",
              " 'minggu': 542,\n",
              " 'besok': 543,\n",
              " 'lulus': 544,\n",
              " 'memilih': 545,\n",
              " 'bangsa': 546,\n",
              " 'gmn': 547,\n",
              " 'mencari': 548,\n",
              " 'sd': 549,\n",
              " 't': 550,\n",
              " 'kota': 551,\n",
              " 'dibilang': 552,\n",
              " 'sekedar': 553,\n",
              " 'laki': 554,\n",
              " 'partai': 555,\n",
              " 'jujur': 556,\n",
              " 'dirinya': 557,\n",
              " 'terakhir': 558,\n",
              " 'ulang': 559,\n",
              " 'kenal': 560,\n",
              " 'berat': 561,\n",
              " 'pikir': 562,\n",
              " 'keren': 563,\n",
              " 'termasuk': 564,\n",
              " 'tgl': 565,\n",
              " 'macam': 566,\n",
              " 'suara': 567,\n",
              " 'cm': 568,\n",
              " 'minum': 569,\n",
              " 'bang': 570,\n",
              " 'masing': 571,\n",
              " 'sebenernya': 572,\n",
              " 'of': 573,\n",
              " 'engga': 574,\n",
              " 'ingat': 575,\n",
              " 'kayaknya': 576,\n",
              " 'sejak': 577,\n",
              " 'sumpah': 578,\n",
              " 'sahur': 579,\n",
              " 'an': 580,\n",
              " 'hasil': 581,\n",
              " 'jahat': 582,\n",
              " 'tersenyum': 583,\n",
              " 'knp': 584,\n",
              " 'uda': 585,\n",
              " 'gamau': 586,\n",
              " 'masyarakat': 587,\n",
              " 'ngerasain': 588,\n",
              " 'gagal': 589,\n",
              " 'buku': 590,\n",
              " 'berharap': 591,\n",
              " 'suami': 592,\n",
              " 'terhadap': 593,\n",
              " 'aq': 594,\n",
              " 'bayar': 595,\n",
              " 'mudah': 596,\n",
              " 'asik': 597,\n",
              " 'warga': 598,\n",
              " 'satunya': 599,\n",
              " 'inget': 600,\n",
              " 'beneran': 601,\n",
              " 'sibuk': 602,\n",
              " 'korban': 603,\n",
              " 'ampe': 604,\n",
              " 'video': 605,\n",
              " 'pdhl': 606,\n",
              " 'ngeliat': 607,\n",
              " 'kehilangan': 608,\n",
              " 'nama': 609,\n",
              " 'daripada': 610,\n",
              " 'tepat': 611,\n",
              " 'lainnya': 612,\n",
              " 'denger': 613,\n",
              " 'msh': 614,\n",
              " 'nomor': 615,\n",
              " 'muda': 616,\n",
              " 'isi': 617,\n",
              " 'kamar': 618,\n",
              " 'harga': 619,\n",
              " 'segera': 620,\n",
              " 'pihak': 621,\n",
              " 'min': 622,\n",
              " 'kasus': 623,\n",
              " 'kesempatan': 624,\n",
              " 'dpt': 625,\n",
              " 'nyari': 626,\n",
              " 'kaga': 627,\n",
              " 'disuruh': 628,\n",
              " 'wah': 629,\n",
              " 'ndak': 630,\n",
              " 'itulah': 631,\n",
              " 'dateng': 632,\n",
              " 'ngapain': 633,\n",
              " 'loe': 634,\n",
              " 'walau': 635,\n",
              " 'berasa': 636,\n",
              " 'cepat': 637,\n",
              " 'berapa': 638,\n",
              " 'motor': 639,\n",
              " 'dm': 640,\n",
              " 'mimpi': 641,\n",
              " 'negeri': 642,\n",
              " 'hubungan': 643,\n",
              " 'badan': 644,\n",
              " 'memberi': 645,\n",
              " 'mantan': 646,\n",
              " 'berbeda': 647,\n",
              " 'sesama': 648,\n",
              " 'gaada': 649,\n",
              " 'kasian': 650,\n",
              " 'enggak': 651,\n",
              " 'selain': 652,\n",
              " 'ni': 653,\n",
              " 'mba': 654,\n",
              " 'cowok': 655,\n",
              " 'ketawa': 656,\n",
              " 'nyata': 657,\n",
              " 'it': 658,\n",
              " 'tangan': 659,\n",
              " 'ganteng': 660,\n",
              " 'intinya': 661,\n",
              " '7': 662,\n",
              " 'ikhlas': 663,\n",
              " 'kehidupan': 664,\n",
              " 'dll': 665,\n",
              " 'tsb': 666,\n",
              " 'serta': 667,\n",
              " 'kesel': 668,\n",
              " 'rame': 669,\n",
              " 'hujan': 670,\n",
              " 'berjalan': 671,\n",
              " 'hingga': 672,\n",
              " 'drama': 673,\n",
              " 'amp': 674,\n",
              " 'kirim': 675,\n",
              " 'cepet': 676,\n",
              " 'diajak': 677,\n",
              " 'wkwkwk': 678,\n",
              " 'km': 679,\n",
              " 'kemaren': 680,\n",
              " 'oke': 681,\n",
              " 'untung': 682,\n",
              " 'lakukan': 683,\n",
              " 'pribadi': 684,\n",
              " 'gede': 685,\n",
              " 'tol': 686,\n",
              " 'merasakan': 687,\n",
              " 'lho': 688,\n",
              " 'sendirian': 689,\n",
              " 'menerima': 690,\n",
              " 'asal': 691,\n",
              " 'grup': 692,\n",
              " 'pasangan': 693,\n",
              " 'seharusnya': 694,\n",
              " 'status': 695,\n",
              " 'tersebut': 696,\n",
              " 'sekitar': 697,\n",
              " 'belakang': 698,\n",
              " 'kmrn': 699,\n",
              " 'lgsg': 700,\n",
              " 'ramadhan': 701,\n",
              " 'bla': 702,\n",
              " 'asli': 703,\n",
              " 'khawatir': 704,\n",
              " 'giliran': 705,\n",
              " 'pilihan': 706,\n",
              " 'for': 707,\n",
              " 'sebelumnya': 708,\n",
              " 'dirimu': 709,\n",
              " 'istri': 710,\n",
              " 'calon': 711,\n",
              " 'barang': 712,\n",
              " 'tugas': 713,\n",
              " 'bakalan': 714,\n",
              " 'sehingga': 715,\n",
              " 'gara': 716,\n",
              " 'tiket': 717,\n",
              " 'keliatan': 718,\n",
              " 'pemerintah': 719,\n",
              " 'mandi': 720,\n",
              " 'acara': 721,\n",
              " 'ko': 722,\n",
              " 'pancasila': 723,\n",
              " 'cita': 724,\n",
              " 'sholat': 725,\n",
              " 'maha': 726,\n",
              " 'al': 727,\n",
              " 'yaudah': 728,\n",
              " 'tetapi': 729,\n",
              " 'ilmu': 730,\n",
              " 'meskipun': 731,\n",
              " 'kaki': 732,\n",
              " 'heran': 733,\n",
              " 'dokter': 734,\n",
              " 'oldmoneygakngerasain': 735,\n",
              " 'dek': 736,\n",
              " 'on': 737,\n",
              " 'kedua': 738,\n",
              " 'pemimpin': 739,\n",
              " 'smp': 740,\n",
              " 'anjir': 741,\n",
              " 'supaya': 742,\n",
              " 'berdoa': 743,\n",
              " 'gubernur': 744,\n",
              " 'abang': 745,\n",
              " 'turun': 746,\n",
              " 'harusnya': 747,\n",
              " 'apa2': 748,\n",
              " 'harapan': 749,\n",
              " 'bank': 750,\n",
              " 'jadinya': 751,\n",
              " 'lanjut': 752,\n",
              " 'usaha': 753,\n",
              " 'pikiran': 754,\n",
              " 'buruk': 755,\n",
              " 'tenang': 756,\n",
              " 'telat': 757,\n",
              " 'trauma': 758,\n",
              " 'capek': 759,\n",
              " 'perhatian': 760,\n",
              " 'td': 761,\n",
              " 'thn': 762,\n",
              " 'adek': 763,\n",
              " 'sesuai': 764,\n",
              " 'aing': 765,\n",
              " 'bentuk': 766,\n",
              " 'awalnya': 767,\n",
              " 'bu': 768,\n",
              " 'engkau': 769,\n",
              " 'harassment': 770,\n",
              " 'sungguh': 771,\n",
              " 'masak': 772,\n",
              " 'berkata': 773,\n",
              " 'alam': 774,\n",
              " 'bro': 775,\n",
              " 'cek': 776,\n",
              " 'beri': 777,\n",
              " 'jogja': 778,\n",
              " 'plastik': 779,\n",
              " 'siap': 780,\n",
              " 'adanya': 781,\n",
              " 'dasar': 782,\n",
              " 'daerah': 783,\n",
              " 'huhu': 784,\n",
              " 'selesai': 785,\n",
              " 'kyk': 786,\n",
              " 'justru': 787,\n",
              " 'kerjaan': 788,\n",
              " 'y': 789,\n",
              " 'sbg': 790,\n",
              " 'koruptor': 791,\n",
              " 'speak': 792,\n",
              " 'berita': 793,\n",
              " 'dengerin': 794,\n",
              " 'terasa': 795,\n",
              " 'rmh': 796,\n",
              " 'is': 797,\n",
              " 'siapapun': 798,\n",
              " 'yak': 799,\n",
              " 'bukti': 800,\n",
              " 'peduli': 801,\n",
              " 'kesehatan': 802,\n",
              " 'situ': 803,\n",
              " 'korupsi': 804,\n",
              " 'b': 805,\n",
              " 'menit': 806,\n",
              " 'ttg': 807,\n",
              " 'menunggu': 808,\n",
              " 'time': 809,\n",
              " 'jarang': 810,\n",
              " 'kepala': 811,\n",
              " 'kopi': 812,\n",
              " 'menikmati': 813,\n",
              " 'polisi': 814,\n",
              " 'lancar': 815,\n",
              " 'sepi': 816,\n",
              " 'dibawa': 817,\n",
              " 'program': 818,\n",
              " 'instagram': 819,\n",
              " 'paket': 820,\n",
              " 'antara': 821,\n",
              " 'rusak': 822,\n",
              " 'kudu': 823,\n",
              " 'berjuang': 824,\n",
              " 'bicara': 825,\n",
              " 'bodoh': 826,\n",
              " 'jawaban': 827,\n",
              " 'kasihan': 828,\n",
              " 'sempet': 829,\n",
              " 'isinya': 830,\n",
              " 'urusan': 831,\n",
              " 'tiba2': 832,\n",
              " 'tambah': 833,\n",
              " 'mesti': 834,\n",
              " 'barusan': 835,\n",
              " 'perjalanan': 836,\n",
              " 'slalu': 837,\n",
              " 'lebay': 838,\n",
              " 'dirumah': 839,\n",
              " 'macem': 840,\n",
              " 'dosa': 841,\n",
              " 'kaget': 842,\n",
              " 'demen': 843,\n",
              " 'mendukung': 844,\n",
              " 'meski': 845,\n",
              " 'musik': 846,\n",
              " 'kuota': 847,\n",
              " 'thr': 848,\n",
              " 'se': 849,\n",
              " 'ma': 850,\n",
              " 'kecewa': 851,\n",
              " 'kepikiran': 852,\n",
              " 'kampus': 853,\n",
              " 'kosong': 854,\n",
              " 'panas': 855,\n",
              " 'seminggu': 856,\n",
              " 'macet': 857,\n",
              " 'nyinyir': 858,\n",
              " 'kesalahan': 859,\n",
              " 'duh': 860,\n",
              " 'ambil': 861,\n",
              " 'skripsi': 862,\n",
              " 'tertawa': 863,\n",
              " 'duluan': 864,\n",
              " 'hatiku': 865,\n",
              " 'tim': 866,\n",
              " 'berhasil': 867,\n",
              " 'terutama': 868,\n",
              " 'kakak': 869,\n",
              " 'dekat': 870,\n",
              " 'pintu': 871,\n",
              " 'berhenti': 872,\n",
              " 'mirip': 873,\n",
              " 'rajin': 874,\n",
              " 'bunuh': 875,\n",
              " 'memiliki': 876,\n",
              " 'manis': 877,\n",
              " 'hak': 878,\n",
              " 'jaga': 879,\n",
              " 'sengaja': 880,\n",
              " 'wajar': 881,\n",
              " 'pasar': 882,\n",
              " 'media': 883,\n",
              " 'kini': 884,\n",
              " 'kawan': 885,\n",
              " 'berikan': 886,\n",
              " 'nilai': 887,\n",
              " 'arah': 888,\n",
              " 'meninggal': 889,\n",
              " 'mo': 890,\n",
              " 'libur': 891,\n",
              " 'nunggu': 892,\n",
              " 'bahaya': 893,\n",
              " 'kaum': 894,\n",
              " 'kpd': 895,\n",
              " 'hukum': 896,\n",
              " 'jari': 897,\n",
              " 'sang': 898,\n",
              " 'be': 899,\n",
              " 'tutup': 900,\n",
              " 'pelajaran': 901,\n",
              " 'all': 902,\n",
              " 'tujuan': 903,\n",
              " 'tukang': 904,\n",
              " 'setuju': 905,\n",
              " 'this': 906,\n",
              " 'hmm': 907,\n",
              " 'kebanyakan': 908,\n",
              " 'bawah': 909,\n",
              " 'bali': 910,\n",
              " 'hilang': 911,\n",
              " 'bertemu': 912,\n",
              " 'tanah': 913,\n",
              " 'males': 914,\n",
              " 'stiap': 915,\n",
              " 'emak': 916,\n",
              " 'rela': 917,\n",
              " 'lepas': 918,\n",
              " 'bahasa': 919,\n",
              " 'x': 920,\n",
              " 'untukmu': 921,\n",
              " 'fokus': 922,\n",
              " 'merinding': 923,\n",
              " 'cc': 924,\n",
              " 'sekian': 925,\n",
              " 'disaat': 926,\n",
              " 'mengatakan': 927,\n",
              " 'komen': 928,\n",
              " 'aman': 929,\n",
              " 'mulut': 930,\n",
              " 'deg': 931,\n",
              " 'mencintaimu': 932,\n",
              " 'betapa': 933,\n",
              " 'kondisi': 934,\n",
              " 'data': 935,\n",
              " 'bantu': 936,\n",
              " 'menyenangkan': 937,\n",
              " 'medsos': 938,\n",
              " 'masjid': 939,\n",
              " 'amin': 940,\n",
              " 'pertanyaan': 941,\n",
              " 'birthday': 942,\n",
              " 'hebat': 943,\n",
              " 'guru': 944,\n",
              " 'kabur': 945,\n",
              " 'seru': 946,\n",
              " 'setengah': 947,\n",
              " 'ngasih': 948,\n",
              " 'ttp': 949,\n",
              " 'pinter': 950,\n",
              " 'temen2': 951,\n",
              " 'kejadian': 952,\n",
              " 'kelar': 953,\n",
              " 'disana': 954,\n",
              " 'lampu': 955,\n",
              " 'merah': 956,\n",
              " 'bukannya': 957,\n",
              " 'kesini': 958,\n",
              " 'maju': 959,\n",
              " 'obat': 960,\n",
              " 'berdua': 961,\n",
              " 'rezeki': 962,\n",
              " 'rambut': 963,\n",
              " 'saudara': 964,\n",
              " 'allaah': 965,\n",
              " 'bekerja': 966,\n",
              " 'dibuat': 967,\n",
              " 'benci': 968,\n",
              " 'bandung': 969,\n",
              " 'bukber': 970,\n",
              " 'caranya': 971,\n",
              " 'diriku': 972,\n",
              " 'bertahan': 973,\n",
              " 'pesan': 974,\n",
              " 'sepertinya': 975,\n",
              " 'gegara': 976,\n",
              " 'pindah': 977,\n",
              " 'tulus': 978,\n",
              " 'masi': 979,\n",
              " 'dn': 980,\n",
              " 'ayah': 981,\n",
              " 'askmf': 982,\n",
              " 'curhat': 983,\n",
              " 'berbagi': 984,\n",
              " 'pengalaman': 985,\n",
              " 'ngatain': 986,\n",
              " 'menganggap': 987,\n",
              " 'tuk': 988,\n",
              " 'dianggap': 989,\n",
              " 'berada': 990,\n",
              " 'tangga': 991,\n",
              " 'kira': 992,\n",
              " 'ujian': 993,\n",
              " 'wkwkw': 994,\n",
              " 'berkah': 995,\n",
              " 'efek': 996,\n",
              " 'sebelah': 997,\n",
              " 'mudik': 998,\n",
              " 'semacam': 999,\n",
              " 'ngakak': 1000,\n",
              " ...}"
            ]
          },
          "metadata": {},
          "execution_count": 9
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "X = pad_sequences(X, maxlen=MAX_SEQUENCE_LENGTH)\n",
        "Y = pd.get_dummies(df['label']).values\n",
        "X_train, X_test, Y_train, Y_test = train_test_split(X,Y, test_size = 0.10, random_state = 42)"
      ],
      "metadata": {
        "id": "sLp6Hql_aM-R"
      },
      "execution_count": 11,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "X"
      ],
      "metadata": {
        "id": "GTA030WgaM_g",
        "outputId": "e64a995c-7f10-4a7b-9930-06fa78929bd0",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 12,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([[  0,   0,   0, ...,   1,   1,  19],\n",
              "       [  0,   0,   0, ..., 983,  68,  86],\n",
              "       [  0,   0,   0, ..., 984,   8, 523],\n",
              "       ...,\n",
              "       [  0,   0,   0, ...,  30,  31, 271],\n",
              "       [  0,   0,   0, ...,  76,  65,  30],\n",
              "       [  0,   0,   0, ...,   7,  10,  95]], dtype=int32)"
            ]
          },
          "metadata": {},
          "execution_count": 12
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "X_train.shape"
      ],
      "metadata": {
        "id": "NBqxsABAaNB1",
        "outputId": "80da8e8b-693f-4b35-fbec-6a93c924ed52",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 13,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(3960, 355)"
            ]
          },
          "metadata": {},
          "execution_count": 13
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "model = Sequential()\n",
        "model.add(Embedding(MAX_WORDS, EMBEDDING_DIM, input_length=X_train.shape[1]))\n",
        "model.add(SpatialDropout1D(0.2))\n",
        "model.add(LSTM(100, dropout=0.2, recurrent_dropout=0.2))\n",
        "model.add(Dense(3, activation='softmax'))\n",
        "model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])\n",
        "\n",
        "epochs = 5\n",
        "batch_size = 64\n",
        "\n",
        "history = model.fit(X_train, Y_train, epochs=epochs, batch_size=batch_size,validation_split=0.1)"
      ],
      "metadata": {
        "id": "ba08xPZkaNEs",
        "outputId": "60118fd1-2546-4ff1-9571-44ce8ff0027b",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 772
        }
      },
      "execution_count": 14,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Epoch 1/5\n"
          ]
        },
        {
          "output_type": "error",
          "ename": "ValueError",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-14-d9409b9300bc>\u001b[0m in \u001b[0;36m<cell line: 11>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[0mbatch_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m64\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 11\u001b[0;31m \u001b[0mhistory\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_train\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mY_train\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mepochs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mepochs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbatch_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mbatch_size\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mvalidation_split\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m0.1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
            "\u001b[0;32m/usr/local/lib/python3.10/dist-packages/keras/src/utils/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     68\u001b[0m             \u001b[0;31m# To get the full stack trace, call:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     69\u001b[0m             \u001b[0;31m# `tf.debugging.disable_traceback_filtering()`\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 70\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwith_traceback\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfiltered_tb\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     71\u001b[0m         \u001b[0;32mfinally\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     72\u001b[0m             \u001b[0;32mdel\u001b[0m \u001b[0mfiltered_tb\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py\u001b[0m in \u001b[0;36mtf__train_function\u001b[0;34m(iterator)\u001b[0m\n\u001b[1;32m     13\u001b[0m                 \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     14\u001b[0m                     \u001b[0mdo_return\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 15\u001b[0;31m                     \u001b[0mretval_\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mag__\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mconverted_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mag__\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mld\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mstep_function\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mag__\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mld\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mag__\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mld\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0miterator\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfscope\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     16\u001b[0m                 \u001b[0;32mexcept\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     17\u001b[0m                     \u001b[0mdo_return\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mValueError\u001b[0m: in user code:\n\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py\", line 1401, in train_function  *\n        return step_function(self, iterator)\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py\", line 1384, in step_function  **\n        outputs = model.distribute_strategy.run(run_step, args=(data,))\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py\", line 1373, in run_step  **\n        outputs = model.train_step(data)\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py\", line 1151, in train_step\n        loss = self.compute_loss(x, y, y_pred, sample_weight)\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py\", line 1209, in compute_loss\n        return self.compiled_loss(\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/engine/compile_utils.py\", line 277, in __call__\n        loss_value = loss_obj(y_t, y_p, sample_weight=sw)\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/losses.py\", line 143, in __call__\n        losses = call_fn(y_true, y_pred)\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/losses.py\", line 270, in call  **\n        return ag_fn(y_true, y_pred, **self._fn_kwargs)\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/losses.py\", line 2221, in categorical_crossentropy\n        return backend.categorical_crossentropy(\n    File \"/usr/local/lib/python3.10/dist-packages/keras/src/backend.py\", line 5573, in categorical_crossentropy\n        target.shape.assert_is_compatible_with(output.shape)\n\n    ValueError: Shapes (None, 5) and (None, 3) are incompatible\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "accr = model.evaluate(X_test,Y_test)\n",
        "print('Test set\\n  Loss: {:0.3f}\\n  Accuracy: {:0.3f}'.format(accr[0],accr[1]))"
      ],
      "metadata": {
        "id": "MWxf0Fk9ad_n"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "X_test=['อย่า ลืม ติดตาม ชม รายการ พิเศษ','ด่วน ลด แบบ จัดเต็ม ของแถม มากมาย']\n",
        "X_test=tokenizer.texts_to_sequences(X_test)\n",
        "X_test=pad_sequences(X_test, maxlen=MAX_SEQUENCE_LENGTH)\n",
        "model.predict(X_test)"
      ],
      "metadata": {
        "id": "pIkLUX0baeBe"
      },
      "execution_count": null,
      "outputs": []
    }
  ],
  "metadata": {
    "colab": {
      "name": "Selamat Datang di Colaboratory",
      "provenance": [],
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}